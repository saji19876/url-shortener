{% extends "base.html" %}
{% load humanize %}

{% block title %}Short URL Report for {{ user }} in the last {{timeframe}}{% endblock %}

{% block content %}
<h2 class="s3 margin_bottom_halfem">Link Report for {{ user }} in the last {{timeframe}}</h2>
<p class="s4 margin_bottom_1em">Views: {{totals|intcomma}} Clicks: {{totals2|intcomma}}</p>
{% if user.is_authenticated %}
    {% ifequal user.id request.user.id %}
        <h3>API Key: {{request.user.get_profile.api_key}}</h3>
    {% endifequal %}
{% endif %}
<table id="user_link_data">
    <thead>
        <tr class="s5 margin_bottom_1em">
            <th>Info</th>
            <th>Long</th>
            <th>Clicks</th>
            <th>Views</th>
            <th>CTR</th>
            <th>CTR_w</th>
        </tr>
    </thead>
    <tbody >
        {% for link in links %}
            <tr>
                <td style="font-family:monospace;"><a href="{{link.short_url}}+">{{link.short_url|cut:"http://"}}</a></td>
                <td><a href="{{link.short_url}}">{{link.url|slice:":35"}}</a></td>
                <td>{{link.clicks}}</td>
                <td>{{link.views}}</td>
                <td>{{link.ctr|floatformat:2}}</td>
                <td>{{link.ctr_w|floatformat:0}}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
{% block sidebar %}
<div class="margin_top_1em margin_bottom_halfem"><em class="s4">Tools</em></div>
<ul>
    <li><a href="{% url user_info_none user.id,user.username %}">This week</a></li>
    <li><a href="{% url user_info_timetable user.id,user.username,'month' %}">This month</a></li>
    <li><a href="{% url user_info_timetable user.id,user.username,'year' %}">This year</a></li>
</ul>
{% endblock %}
{% block extra_scripts %}
<script src="{{MEDIA_URL}}/js/jquery.tablesorter.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8">
    $(document).ready(function(){ 
        $("#user_link_data").tablesorter(); 
    });
</script>
{% endblock %}

